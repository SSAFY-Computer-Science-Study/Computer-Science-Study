# Chapter 04. CPU의 작동 원리


## 04-1. ALU와 제어장치

CPU의 구성 요소 중 ALU와 제어 장치를 알아보기

### ALU

---

- 들어오는 정보
    - ALU는 레지스터를 통해 피여난자를 받아들이고, 제어장치로부터 수행할 연산을 알려주는 제어 신호를 받아들임
    - ALU는 피연산자와 제어신호로 산술 연산, 논리 연산 등 다양한 연산을 수행함
- 내보내는 정보
    - 수행한 결과는 특정 값이 될 수도 있고, 메모리 주소가 될 수도 있음
    - 이 결괏값은 바로 메모리에 저장되지 않고 일시적으로 `레지스터`에 저장됨
    - 결괏값과 더불어 `플래그`를 내보냄
        - 연산 결과에 대한 추가적인 정보
        - ex) 연산 결과가 음수이다, 결괏값이 너무 크다 등등
        - 플래그들은 플래그 레지스터에 저장됨

![image.png](https://github.com/user-attachments/assets/7fe4fc5b-2a2d-4ea4-9e80-9b5dad3fa526)

### 제어장치

---

- 제어장치
    - 제어 신호를 내보내고, 명령어를 해석하는 부품
- 제어 신호
    - 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호
- 들어오는 정보
    - `클럭` 신호
    - 해석해야 할 `명령어`
    - 플래그 레지스터 속 플래그 값
    - 시스템 버스, 그 중에서 제어버스로 전달된 제어 신호

![image.png](https://github.com/user-attachments/assets/a2635c40-36a0-433d-9ec0-9962951c8a5d)

> `클럭`
> - 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위
> - 컴퓨터의 모든 부품이 클럭 신호에 맞춰 작동한다 ≠ 컴퓨터의 모든 부품이 한 클럭마다 작동한다
> - 하나의 명령어가 여러 클럭에 걸쳐 실행될 수 있다
> ![image.png](https://github.com/user-attachments/assets/199ef225-6ef9-4033-bd48-fe6c3f2c6da4)

> 제어 장치가 CPU 내부에 전달하는 제어 신호
> - ALU에 전달하는 제어 신호
>    - 수행할 연산을 지시하기 위함
> - 레지스터에 전달하는 제어 신호
>    - 레지스터 간에 데이터를 이동시키거나 레지스터에 저장된 명령어를 해석하기 위함

## 04-2. 레지스터

레지스터의 종류와 역할을 학습하고, 각 레지스터를 통해 명령어가 처리되는 과정을 이해하자

- 프로그램 속 명령어와 데이터는 실행 전후로 반드시 레지스터에 저장됨

### 반드시 알아야 할 레지스터

---

- 많은 CPU가 공통으로 포함하고 있는 여덟 개의 레지스터
    - 프로그램 카운터
        - 메모리에서 가져올 명령어의 주소
        - 명령어 포인터(IP)
        - 프로그램이 순차적으로 읽어들이고 실행할 수 있는 이유는 프로그램 카운터가 증가하기 때문
    - 명령어 레지스터
        - 해석할 명령어
    - 메모리 주소 레지스터
        - 메모리의 주소 저장
        - `주소 버스로 내보낼 주소값만` 저장
        - CPU가 `읽어 들이고자 하는 주소 값`을 `주소 버스`로 보낼 때 메모리 주소 레지스터를 거치게 됨
    - 메모리 버퍼 레지스터
        - 메모리에 쓰고 싶은 값이나 메모리로부터 전달받은 값을 저장하는 레지스터
        - 메모리 데이터 레지스터(MDR)
        - `데이터 버스로 주고 받을 값만` 저장
    - 플래그 레지스터
    - 범용 레지스터
        - 데이터와 주소 모두 저장 가능
    - 스택 포인터
        - 스택의 꼭대기를 가리키는 레지스터
        - 스택에 마지막으로 저장된 값의 위치를 저장한 레지스터
    - 베이스 레지스터

![image.png](https://github.com/user-attachments/assets/a8d2c918-6265-4714-9c5d-c339f51f2de1)

![image.png](https://github.com/user-attachments/assets/ebd0c47d-da2b-42a0-913c-0f5056949876)

![image.png](https://github.com/user-attachments/assets/b4d6a653-496b-4ed4-aea8-e733770f78b3)

### 특정 레지스터를 이용한 주소 지정 방식

---

- 스택 주소 지정 방식
    - 스택과 스택 포인터를 이용한 주소 지정 방식
    - `스택 포인터`와 `베이스 레지스터`가 주소 지정에 사용될 수 있는 특별한 레지스터
- 변위 주소 지정 방식
    - 오퍼랜드 필드의 값(변위)과 특정 레지스터의 값을 더하여 유효주소를 얻는 방식
    - 어떤 주소와 레지스터를 사용하느냐에 따라 상대 주소 지정 방식, 베이스 레지스터 주소 지정 방식으로 나뉨
    - 상대 주소 지정 방식
        - 오퍼랜드와 `프로그램 카운터`의 값을 더하여 유효 주소를 얻는 방식
        - 프로그램 카운터에는 읽어들일 명령어의 주소가 저장되어 있으므로 이를 기준으로 상대적으로 위치 찾기
    - 베이스 레지스터 주소 지정 방식
        - 오퍼랜드와 `베이스 레지스터`의 값을 더하여 유효 주소를 얻는 방식
        - 베이스 레지스터는 기준 주소, 오퍼랜드는 기준 주소로부터 떨어진 거리의 역할을 함
        - 베이스 레지스터 속 기준 주소로부터 얼마나 떨어져 있는 주소에 접근할 것인지 연산해 얻어내는 방식